<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa1_2021li1g085</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>LingYun Zhu &lt;a100820@alunos.uminho.pt&gt;;<br />: Ana Margarida Sousa Pimenta &lt;a100830@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa1_2021li1g085</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 1 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:validaPotencialMapa">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:pecaCoorEmCoor">pecaCoorEmCoor</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:vPecaPorPosicao">vPecaPorPosicao</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:unicaPorta">unicaPorta</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int -&gt; Bool</li><li class="src short"><a href="#v:nflutua">nflutua</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:procuraCaixa">procuraCaixa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:procuraBase">procuraBase</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:dimensaoMatriz">dimensaoMatriz</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:espacoVazio">espacoVazio</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:existeEspVazio">existeEspVazio</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:soBlocos">soBlocos</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:firstBloco">firstBloco</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:quickBlocos">quickBlocos</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:parteBlocos">parteBlocos</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; ([<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>], [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>])</li><li class="src short"><a href="#v:blocoPiso">blocoPiso</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:blocoPisoChao">blocoPisoChao</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:validaPotencialMapa" class="def">validaPotencialMapa</a> <a href="#v:validaPotencialMapa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>argumento </p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>validade do Mapa</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:validaPotencialMapa" title="Tarefa1_2021li1g085">validaPotencialMapa</a></code> junta fun&#231;&#245;es secund&#225;rias de modo a poder validar o mapa.</p><p>Esta &#233; definida da seguinte forma:</p><pre>validaPotencialMapa :: [(Peca, Coordenadas)] -&gt; Bool
validaPotencialMapa [] = False
validaPotencialMapa a = vPecaPorPosicao x xs &amp;&amp; unicaPorta a 0 &amp;&amp; nflutua a &amp;&amp; existeEspVazio a &amp;&amp; blocoPisoChao a
    where
     (x:xs) = pecaCoorEmCoor a
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>validaPotenciaMapa m1
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:pecaCoorEmCoor" class="def">pecaCoorEmCoor</a> <a href="#v:pecaCoorEmCoor" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista de <code><a href="LI12122.html#t:Peca" title="LI12122">Peca</a></code> e <code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code></p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>lista de <code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code></p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:pecaCoorEmCoor" title="Tarefa1_2021li1g085">pecaCoorEmCoor</a></code> transforma o argumento para uma lista de <code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code>, de modo a poderem ser comparadas.</p><pre>pecaCoorEmCoor :: [(Peca, Coordenadas)] -&gt; [Coordenadas]
pecaCoorEmCoor [] = []
pecaCoorEmCoor ((_,(b,c)):t) = (b,c) : pecaCoorEmCoor t
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>pecaCoorEmCoor [(Bloco,(0,2)),(Caixa,(3,3)),(Porta,(0,2))]
</code></strong>[(0,2),(3,3),(0,2)]
</pre></div></div><div class="top"><p class="src"><a id="v:vPecaPorPosicao" class="def">vPecaPorPosicao</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Bool <a href="#v:vPecaPorPosicao" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:vPecaPorPosicao" title="Tarefa1_2021li1g085">vPecaPorPosicao</a></code> recorre &#224; fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:pecaCoorEmCoor" title="Tarefa1_2021li1g085">pecaCoorEmCoor</a></code> para verificar se existem duas pe&#231;as a ocupar a mesma posi&#231;&#227;o.</p><pre>vPecaPorPosicao :: Coordenadas -&gt; [Coordenadas] -&gt; Bool 
vPecaPorPosicao _ [] = True
vPecaPorPosicao a (b:t) | elem a (b:t) = False 
                        | otherwise = vPecaPorPosicao b t
</pre></div></div><div class="top"><p class="src"><a id="v:unicaPorta" class="def">unicaPorta</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int -&gt; Bool <a href="#v:unicaPorta" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:unicaPorta" title="Tarefa1_2021li1g085">unicaPorta</a></code> soma 1 ao acumulador sempre que aparece Porta na lista. </p><pre>unicaPorta :: [(Peca,Coordenadas)] -&gt; Int -&gt; Bool 
unicaPorta [] ac | ac == 0 = False
                 | otherwise = True
unicaPorta ((a,(b,c)):t) ac | ac &gt; 1 = False
                            | a == Porta = unicaPorta t (ac+1)
                            | otherwise  = unicaPorta t ac
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>unicaPorta [(Porta,(0,0)),(Porta,(1,0))]
</code></strong>False
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>unicaPorta m1
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:nflutua" class="def">nflutua</a> <a href="#v:nflutua" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>inexist&#234;ncia de <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code> a flutuar</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:nflutua" title="Tarefa1_2021li1g085">nflutua</a></code> certifica de que n&#227;o h&#225; nenhuma <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code> a flutuar.</p><ul><li>- | Recorre-se a <code><a href="Tarefa1_2021li1g085.html#v:procuraCaixa" title="Tarefa1_2021li1g085">procuraCaixa</a></code></li></ul><pre>nflutua :: [(Peca,Coordenadas)] -&gt; Bool 
nflutua [] = True 
nflutua l = procuraCaixa l l
</pre></div></div><div class="top"><p class="src"><a id="v:procuraCaixa" class="def">procuraCaixa</a> <a href="#v:procuraCaixa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista</p></td></tr><tr><td class="src">-&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista inicial completa</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>inexist&#234;ncia de <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code> a flutuar</p></td></tr></table></div><div class="doc"><ul><li>- * Quando se encontra uma <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code> na lista, procura-se a base da mesma.</li></ul><pre>procuraCaixa :: [(Peca,Coordenadas)]-&gt; [(Peca,Coordenadas)] -&gt; Bool 
procuraCaixa [] _ = True
procuraCaixa ((a,b):t) l | a == Caixa = procuraBase (a,b) l &amp;&amp; procuraCaixa t l
                         | otherwise  = procuraCaixa t l
</pre></div></div><div class="top"><p class="src"><a id="v:procuraBase" class="def">procuraBase</a> <a href="#v:procuraBase" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)</td><td class="doc"><p><code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code> de <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code></p></td></tr><tr><td class="src">-&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista original com todos os elementos</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>inexist&#234;ncia de <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code> a flutuar</p></td></tr></table></div><div class="doc"><ul><li>- * Verifica a existencia de uma <code><a href="LI12122.html#v:Caixa" title="LI12122">Caixa</a></code> ou <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code> numa coordenada a baixo do eixo y.</li></ul><pre>procuraBase :: (Peca,Coordenadas) -&gt; [(Peca,Coordenadas)] -&gt; Bool 
procuraBase _ [] = False
procuraBase (n,(x,y)) ((p,(a,b)):ts) | x == a &amp;&amp; (y+1) == b &amp;&amp; p == Bloco = True
                                     | x == a &amp;&amp; (y+1) == b &amp;&amp; p == Caixa = True
                                     | otherwise = procuraBase (n,(x,y)) ts
</pre></div></div><div class="top"><p class="src"><a id="v:dimensaoMatriz" class="def">dimensaoMatriz</a> <a href="#v:dimensaoMatriz" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>argumento</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>dimens&#227;o da <code>Matriz</code></p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:dimensaoMatriz" title="Tarefa1_2021li1g085">dimensaoMatriz</a></code> busca as maiores coordenadas da lista, e soma se 1 no fim a cada eixo, de modo a compensar as coordenadas nulas.</p><pre>dimensaoMatriz :: [(Peca,Coordenadas)] -&gt; (Coordenadas)
dimensaoMatriz [] = (0,0)
dimensaoMatriz [(a,(c,d))] = (c+1,d+1)
dimensaoMatriz ((p1,(a1,b1)):(p2,(a2,b2)):t) | a1 &gt;= a2 &amp;&amp; b1 &gt;= b2 = dimensaoMatriz ((p1,(a1,b1)):t)
                                             | b1 &gt; b2   = dimensaoMatriz ((p1,(a2,b1)):t)
                                             | a1 &gt; a2   = dimensaoMatriz ((p1,(a1,b2)):t)
                                             | otherwise = dimensaoMatriz ((p1,(a2,b2)):t)
</pre></div></div><div class="top"><p class="src"><a id="v:espacoVazio" class="def">espacoVazio</a> <a href="#v:espacoVazio" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista de elementos do <code><a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></code></p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>existencia de <code><a href="LI12122.html#t:Peca" title="LI12122">Peca</a></code> que seja <code><a href="LI12122.html#v:Vazio" title="LI12122">Vazio</a></code></p></td></tr></table></div><div class="doc"><p>Quando existe <code><a href="LI12122.html#t:Peca" title="LI12122">Peca</a></code> que seja <code><a href="LI12122.html#v:Vazio" title="LI12122">Vazio</a></code> a fun&#231;&#227;o devolve <code>True</code>. </p><pre>espacoVazio :: [(Peca,Coordenadas)] -&gt; Bool
espacoVazio [] = False
espacoVazio ((a,(b,c)):t) | a == Vazio = True 
                          | otherwise = espacoVazio t
</pre></div></div><div class="top"><p class="src"><a id="v:existeEspVazio" class="def">existeEspVazio</a> <a href="#v:existeEspVazio" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista de elementos</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>exist&#234;ncia de espa&#231;o vazio</p></td></tr></table></div><div class="doc"><p>Caso n&#227;o exista <code><a href="LI12122.html#t:Peca" title="LI12122">Peca</a></code> que seja <code><a href="LI12122.html#v:Vazio" title="LI12122">Vazio</a></code>, a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:existeEspVazio" title="Tarefa1_2021li1g085">existeEspVazio</a></code> recorre &#224; compara&#231;&#227;o da dimens&#227;o da <code>Matriz</code> com o n&#250;mero de elementos que esta possui.</p><pre>existeEspVazio :: [(Peca,Coordenadas)] -&gt; Bool
existeEspVazio [] = False
existeEspVazio l | a == False = length l &lt; (x*y)
                 | a == True  = True
   where 
       (x,y) = dimensaoMatriz l
       a     = espacoVazio l
</pre></div></div><div class="top"><p class="src"><a id="v:soBlocos" class="def">soBlocos</a> <a href="#v:soBlocos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>elementos do <code><a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></code></p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>coordenadas dos elementos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:soBlocos" title="Tarefa1_2021li1g085">soBlocos</a></code> gera uma lista so com as cooredenadas de blocos.</p><pre>soBlocos :: [(Peca,Coordenadas)] -&gt; [Coordenadas]
soBlocos [] = []
soBlocos ((a,(b,c)):t) | a == Bloco = (b,c): soBlocos t
                       | otherwise = soBlocos t
</pre></div></div><div class="top"><p class="src"><a id="v:firstBloco" class="def">firstBloco</a> <a href="#v:firstBloco" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>lista s&#243; de <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code></p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>assume-se a exist&#234;ncia de <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code> na coluna 0 </p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>bloco com maior y (situado mais a baixo)</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:firstBloco" title="Tarefa1_2021li1g085">firstBloco</a></code> procura pelo <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code> mais a baixo e mais a <code><a href="LI12122.html#v:Oeste" title="LI12122">Oeste</a></code> da lista.</p><pre>firstBloco :: [Coordenadas] -&gt; Coordenadas -&gt; Coordenadas
firstBloco [] ac = ac
firstBloco ((b,c):t) (x,y) | b == 0 &amp;&amp; c &gt; y = firstBloco t (b,c)
                           | otherwise = firstBloco t (x,y)
</pre></div></div><div class="top"><p class="src"><a id="v:quickBlocos" class="def">quickBlocos</a> <a href="#v:quickBlocos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p><code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code> de <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code></p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p><code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code> ordenadas</p></td></tr></table></div><div class="doc"><p>Esta fun&#231;&#227;o ordena as coordenadas de baixo para cima, de esquerda para a direira, utilizando o algoritmo 'quick sort'. </p><pre>quickBlocos :: [Coordenadas] -&gt; [Coordenadas]
quickBlocos [] = []
quickBlocos (x:xs) = (quickBlocos a1) ++ [x] ++ (quickBlocos a2)

    where
        (a1,a2) = parteBlocos x xs
</pre></div></div><div class="top"><p class="src"><a id="v:parteBlocos" class="def">parteBlocos</a> <a href="#v:parteBlocos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p><code>Coordenada</code> que &#233; utilizada para comparar</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>lista que vai ser ordenada</p></td></tr><tr><td class="src">-&gt; ([<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>], [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>])</td><td class="doc"><p>listas de <code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code> maiores e menores &#224; de compara&#231;&#227;o</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o divide os elementos da lista em duas listas recorrendo a <code>Tupling</code>:</p><ul><li>- * elementos mais a <code>Baixo</code> e a <code>Esquerda</code></li><li>- * elementos mais a <code>Cima</code> e a <code>Direita</code> </li></ul><pre>parteBlocos :: Coordenadas -&gt; [Coordenadas] -&gt; ([Coordenadas],[Coordenadas])
parteBlocos _ [] = ([],[])
parteBlocos (b,c) ((y,z):t) | b &gt; y || (b == y &amp;&amp; c &lt; z) = ((y,z):as,bs)
                            | otherwise = (as,(y,z):bs)
    where
        (as,bs) = parteBlocos (b,c) t
</pre></div></div><div class="top"><p class="src"><a id="v:blocoPiso" class="def">blocoPiso</a> <a href="#v:blocoPiso" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>lista de <code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code> de <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code></p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>recebe o <code><a href="LI12122.html#v:Bloco" title="LI12122">Bloco</a></code> mais a <code><a href="LI12122.html#v:Este" title="LI12122">Este</a></code> e <code>Sul</code></p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>recebe a dimens&#227;o da <code>Matriz</code></p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>veracidade da exist&#234;ncia de um ch&#227;o cont&#237;nuo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:blocoPiso" title="Tarefa1_2021li1g085">blocoPiso</a></code> recebe as coordenadas ordenadas e utiliza um acumulador para comparar a corrente coordenada com a anterior.</p><pre>blocoPiso :: [Coordenadas] -&gt; Coordenadas -&gt; Coordenadas -&gt; Bool
blocoPiso [] _ _ = False
blocoPiso ((h,z):ts) (a,b) (x,y) | a == x = True
                                 | h &lt; a      = blocoPiso ts (a,b) (x,y)
                                 | z == (b+1) = blocoPiso ts (h,z) (x,y)
                                 | z == b     = blocoPiso ts (h,z) (x,y)
                                 | z == (b-1) = blocoPiso ts (h,z) (x,y)
</pre></div></div><div class="top"><p class="src"><a id="v:blocoPisoChao" class="def">blocoPisoChao</a> <a href="#v:blocoPisoChao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>lista dos elementos do <code><a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></code></p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>veracidade da exist&#234;ncia de um ch&#227;o cont&#237;nuo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g085.html#v:blocoPisoChao" title="Tarefa1_2021li1g085">blocoPisoChao</a></code> &#233; utilizada para unir as fun&#231;&#245;es definidas anteriormente.</p><pre>blocoPisoChao :: [(Peca,Coordenadas)] -&gt; Bool 
blocoPisoChao l = blocoPiso td (a,b) (x-1,y-1) 
    where
        (a,b) = firstBloco coor (0,0)
        (x,y) = dimensaoMatriz l
        coor  = soBlocos l
        td    = quickBlocos coor
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>