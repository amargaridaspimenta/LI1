<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa2_2021li1g085</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>LingYun Zhu &lt;a100820@alunos.uminho.pt&gt;;<br />: Ana Margarida Sousa Pimenta &lt;a100830@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa2_2021li1g085</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:constroiMapa">constroiMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></li><li class="src short"><a href="#v:desconstroiMapa">desconstroiMapa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:retiracoor">retiracoor</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:constroiVazios">constroiVazios</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]</li><li class="src short"><a href="#v:atribuiPeca">atribuiPeca</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Peca" title="LI12122">Peca</a></li><li class="src short"><a href="#v:constroilistaPecas">constroilistaPecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]</li><li class="src short"><a href="#v:ordenacoord">ordenacoord</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:ordenaX">ordenaX</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:ordenaY">ordenaY</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:constroimapa">constroimapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></li><li class="src short"><a href="#v:listaX">listaX</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [Int]</li><li class="src short"><a href="#v:listaY">listaY</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [Int]</li><li class="src short"><a href="#v:maxX">maxX</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int</li><li class="src short"><a href="#v:maxY">maxY</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int</li><li class="src short"><a href="#v:parcoormax">parcoormax</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:removeVazio">removeVazio</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:desconstroi">desconstroi</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; (Int, Int) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:inverter">inverter</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:constroiMapa" class="def">constroiMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> <a href="#v:constroiMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>constroiMapa</code> &#233; uma fun&#231;&#227;o que dada uma determinada lista de pe&#231;as e coordenadas produz um mapa, isto &#233;, uma lista de listas de pe&#231;as, sendo estas
respetivamente compostas pelas linhas da matriz que constituem o mapa.
Enquanto que a lista de pe&#231;as e coordenadas n&#227;o apresenta os espa&#231;os Vazio do mapa, este exibe essas mesmas pe&#231;as.</p><p>Quanto &#224; fun&#231;&#227;o <code>desconstroiMapa</code>, esta realiza o inverso da fun&#231;&#227;o <code>constroiMapa</code>, ou seja, dado um determinado mapa, esta fun&#231;&#227;o &#233; capaz de atribuir a cada pe&#231;a
as suas coordenadas, ocultando da sua lista as pe&#231;as correspondentes a Vazio. </p></div></div><div class="top"><p class="src"><a id="v:desconstroiMapa" class="def">desconstroiMapa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:desconstroiMapa" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:retiracoor" class="def">retiracoor</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:retiracoor" class="selflink">#</a></p><div class="doc"><p>Criamos uma fun&#231;&#227;o que, dada uma lista de pe&#231;as e coordenadas, retribui apenas uma lista das coordenadas.</p><p>Exemplo:
Tendo uma lista de pe&#231;as e coordenadas, como por exemplo, [(Bloco,(0,2)),(Vazio,(1,1)),(Caixa,(1,2)),(Vazio,(1,0))], atrav&#233;s da fun&#231;&#227;o <code>retiracoor</code>
&#233; poss&#237;vel obter uma lista constitu&#237;da apenas pelas coordenadas, que seria, neste caso, [(0,2),(1,1),(1,2),(1,0)].</p></div></div><div class="top"><p class="src"><a id="v:constroiVazios" class="def">constroiVazios</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] <a href="#v:constroiVazios" class="selflink">#</a></p><div class="doc"><p>Tal como comentado previamente, a lista de pe&#231;as e coordenadas que &#233; atribu&#237;da &#224; fun&#231;&#227;o <code>constroiMapa</code> n&#227;o apresenta as pe&#231;as Vazio, pelo que, &#233;
assim necess&#225;rio construir uma fun&#231;&#227;o que ir&#225; atribuir essas mesmas pe&#231;as.
Deste modo, atrav&#233;s da fun&#231;&#227;o <code>constroiVazios</code>, dada uma lista de coordenadas (lista 1) e uma outra lista de pe&#231;as e coordenadas (lista 2), esta fun&#231;&#227;o 
ir&#225; verificar se as coordenadas da lista 1 pertecem &#224;s coordenadas da lista 2. Para isso, recorremos &#224; fun&#231;&#227;o auxiliar <code>retiracoor</code>, que constroi uma lista
de coordenadas a partir da lista 2. 
Dado isto, caso a _head_ da lista 1 perten&#231;a &#224; lista 2, a fun&#231;&#227;o <code>constroiVazios</code> recorre &#224; fun&#231;&#227;o auxiliar <code>atribuiPeca</code> que retribui a pe&#231;a que corresponde
&#224;s coordenadas da _head_ da lisa 1. Caso n&#227;o se verifique que a _head_ da lista 1 pertence &#224; lista 2, a fun&#231;&#227;o atribui a essa coordenada um Vazio e verifica o
resto da lista. </p></div></div><div class="top"><p class="src"><a id="v:atribuiPeca" class="def">atribuiPeca</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Peca" title="LI12122">Peca</a> <a href="#v:atribuiPeca" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:constroilistaPecas" class="def">constroilistaPecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] <a href="#v:constroilistaPecas" class="selflink">#</a></p><div class="doc"><p>Dada uma lista de pe&#231;as e coordenadas, a fun&#231;&#227;o <code>constroilistaPecas</code> retribui uma lista de pe&#231;as. Esta fun&#231;&#227;o recorre a v&#225;rias fun&#231;&#245;es auxiliares, sendo
a primeira a fun&#231;&#227;o <code>retiracoor</code>, que ir&#225; criar uma lista de coordenadas a partir da lista de pe&#231;as e coordenadas introduzida. 
Tendo a lista de coordenadas, a fun&#231;&#227;o recorre &#224; fun&#231;&#227;o <code>parcoormax</code>, que retribui um par de coordenadas, sendo este par as coordenadas m&#225;ximas
da matriz que, de seguida, ser&#227;o usadas pela fun&#231;&#227;o <code>ordenacoord</code> de modo a obter uma lista de coordenadas ordenadas. 
Por fim, a fun&#231;&#227;o recorre &#224; fun&#231;&#227;o <code>constroiVazios</code>, que dada a lista de coordenadas j&#225; ordenada e a lista de pe&#231;as e coordenadas, retribui uma lista de 
pe&#231;as que inclui os Vazio. </p></div></div><div class="top"><p class="src"><a id="v:ordenacoord" class="def">ordenacoord</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:ordenacoord" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>ordenacoord</code> ordena as coordenadas <code>x</code> e <code>y</code> que, recorrendo &#224;s fun&#231;&#245;es auxiliares <code>ordenaX</code> e <code>ordenaY</code>, retribui uma lista de coordenadas ordenadas. </p></div></div><div class="top"><p class="src"><a id="v:ordenaX" class="def">ordenaX</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:ordenaX" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:ordenaY" class="def">ordenaY</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:ordenaY" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:constroimapa" class="def">constroimapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> <a href="#v:constroimapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>constroiMapaAux</code> retribui um mapa quando dada uma lista de pe&#231;as e uma outra lista de pe&#231;as e coordenadas. 
Dado que as listas que constituem o mapa s&#227;o constitu&#237;das pelas pe&#231;as que comp&#245;em as linhas da matriz, estas mesmas listas ter&#227;o uma dimens&#227;o igual ao 
n&#250;mero de colunas da matriz, ou seja, o n&#250;mero de elementos dessas listas &#233; igual ao <code>x</code> m&#225;ximo, pelo que, uma das fun&#231;&#245;es auxiliares que iremos utilizar,
ser&#225; a fun&#231;&#227;o <code>maxX</code> que devolve a abcissa m&#225;xima da matriz. 
A fun&#231;ao <code>constroiMapaAux</code> recorre &#224;s fun&#231;&#245;es auxiliares <code>drop</code> e <code>take</code>, pois atrav&#233;s delas conseguimos controlar o tamanho e a forma&#231;&#227;o das listas. 
Como a fun&#231;&#227;o <code>take</code> devolve os <code>n</code> primeiros elementos da lista, e como a fun&#231;&#227;o <code>drop</code> &quot;elimina&quot; esses <code>n</code> elementos da lista, atrav&#233;s da constru&#231;&#227;o 
desta fun&#231;&#227;o recursiva &#233; nos possivel obter a estrutura do mapa.</p></div></div><div class="top"><p class="src"><a id="v:listaX" class="def">listaX</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [Int] <a href="#v:listaX" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>listaX</code>, dada uma lista de coordenadas, retribui uma lista composta apenas pelas abcissas.</p></div></div><div class="top"><p class="src"><a id="v:listaY" class="def">listaY</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [Int] <a href="#v:listaY" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>listaY</code>, dada uma lista de coordenadas, retribui uma lista composta apenas pelas ordenadas.</p></div></div><div class="top"><p class="src"><a id="v:maxX" class="def">maxX</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int <a href="#v:maxX" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>maxX</code> devolve a abcissa m&#225;xima da matriz recorrendo &#224;s fun&#231;&#245;es auxiliares <code>listaX</code> e <code>retiracoor</code>.</p></div></div><div class="top"><p class="src"><a id="v:maxY" class="def">maxY</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int <a href="#v:maxY" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>maxY</code> devolve a ordenada m&#225;xima da matriz recorrendo &#224;s fun&#231;&#245;es auxiliares <code>listaY</code> e <code>retiracoor</code>.</p></div></div><div class="top"><p class="src"><a id="v:parcoormax" class="def">parcoormax</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> <a href="#v:parcoormax" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>parcoormax</code> devolve um par de coordenadas, sendo este par as coordenadas m&#225;ximas da matriz.</p></div></div><div class="top"><p class="src"><a id="v:removeVazio" class="def">removeVazio</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:removeVazio" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>removeVazio</code> &#233; respons&#225;vel por remover os Vazio de uma lista de pe&#231;as e coordenadas e devolver, de seguida, essa nova lista. 
Para isso a fun&#231;&#227;o verifica se a pe&#231;a da _head_ da lista corresponde a Vazio e, se isto se verificar, a fun&#231;&#227;o retira esse conjunto de pe&#231;as e coordenadas
da lista e atua recursivamente sobre a fun&#231;&#227;o. Caso a pe&#231;a da _head_ da lista n&#227;o corresponda ao Vazio, ent&#227;o essa pe&#231;a n&#227;o &#233; removida e a fun&#231;&#227;o atua 
de forma recursiva at&#233; n&#227;o haverem mais elementos na lista. </p></div></div><div class="top"><p class="src"><a id="v:desconstroi" class="def">desconstroi</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; (Int, Int) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:desconstroi" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inverter" class="def">inverter</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> <a href="#v:inverter" class="selflink">#</a></p><div class="doc"><p>Dado que a fun&#231;&#227;o <code>desconstroiMapa</code> retribu&#237;a a lista de pe&#231;as e coordenadas ao contr&#225;rio, usamos a fun&#231;&#227;o <code>inverter</code> que, dado um mapa com uma determinada
sequ&#234;ncia, retribui a sequ&#234;ncia inversa, compensando assim a fun&#231;&#227;o <code>desconstroiMapa</code>. </p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>